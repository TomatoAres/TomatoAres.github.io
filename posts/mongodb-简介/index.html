<!doctype html>
<html lang="zh-cn">
  <head>
    <title>MongoDB 简介 // 西红柿的博客</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.56.3" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="TomatoAres" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://TomatoAres.github.io/css/main.min.59023e5fd38d6ecb0e1dfbb295077c3c67e00e3b9eb3feaf34b5a5e6b332897a.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MongoDB 简介"/>
<meta name="twitter:description" content="MongoDB 是什么  是一个高性能，开源，无模式的文档型数据库， 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。 他支持的数据结构非常松散，采用的是类似 json 的 bjson 格式来存储数据，因此可以存储比较复杂的数据类型。Mongo 最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。  下图展示了 mysql 和 mongoDB 之间的对应关系，我们可以看出来非常的方便，但是 mongoDB 的性能非常好。 优缺点 优点：
 社区活跃，用户较多，应用广泛 MongoDB 在内存充足的情况下数据都放入内存且有完整的索引支持，查询效率较高 MongoDB 的分片机制，支持海量数据的存储和扩展  缺点：
 不支持事务 不支持 join、复杂查询  go 基本操作  链接
s, err := mgo.Dial(addr) .Close()  参数设置
s.SetMode(mgo.Monotonic, true) s.SetPoolLimit(maxPoolLimit) s.SetSocketTimeout(timeout * time.Second)  建表
s.DB(k).C(i).Create(&amp;info)  查询
Find(bson.M{&quot;_id&quot;: id}).One(ret) Find(nil).All() bson.M{&quot;_id&quot;: id} bson.M{} bson.M map[string]interface  修改
bson.M{&quot;$push&quot;: bson.M{&quot;tasks&quot;: ret}} bson."/>

    <meta property="og:title" content="MongoDB 简介" />
<meta property="og:description" content="MongoDB 是什么  是一个高性能，开源，无模式的文档型数据库， 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。 他支持的数据结构非常松散，采用的是类似 json 的 bjson 格式来存储数据，因此可以存储比较复杂的数据类型。Mongo 最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。  下图展示了 mysql 和 mongoDB 之间的对应关系，我们可以看出来非常的方便，但是 mongoDB 的性能非常好。 优缺点 优点：
 社区活跃，用户较多，应用广泛 MongoDB 在内存充足的情况下数据都放入内存且有完整的索引支持，查询效率较高 MongoDB 的分片机制，支持海量数据的存储和扩展  缺点：
 不支持事务 不支持 join、复杂查询  go 基本操作  链接
s, err := mgo.Dial(addr) .Close()  参数设置
s.SetMode(mgo.Monotonic, true) s.SetPoolLimit(maxPoolLimit) s.SetSocketTimeout(timeout * time.Second)  建表
s.DB(k).C(i).Create(&amp;info)  查询
Find(bson.M{&quot;_id&quot;: id}).One(ret) Find(nil).All() bson.M{&quot;_id&quot;: id} bson.M{} bson.M map[string]interface  修改
bson.M{&quot;$push&quot;: bson.M{&quot;tasks&quot;: ret}} bson." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://TomatoAres.github.io/posts/mongodb-%E7%AE%80%E4%BB%8B/" />
<meta property="article:published_time" content="2019-09-11T18:03:09+08:00" />
<meta property="article:modified_time" content="2019-09-11T18:03:09+08:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://TomatoAres.github.io/"><img class="app-header-avatar" src="https://TomatoAres.github.io/avatar.jpg" alt="TomatoAres" /></a>
      <h1>西红柿的博客</h1>
      <p>Awesome TomatoAres</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/TomatoAres"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
          <a target="_blank" href="https://segmentfault.com/u/zhanshenxihongshi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link">
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg></a>
        
          <a target="_blank" href="https://me.csdn.net/shuaishi098"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link">
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg></a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">MongoDB 简介</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Sep 11, 2019
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          1 min read
        </div><div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
          <a class="tag" href="https://TomatoAres.github.io/tags/database/">database</a></div></div>
    </header>
    <div class="post-content">
      

<h2 id="mongodb-是什么">MongoDB 是什么</h2>

<ol>
<li>是一个高性能，开源，无模式的文档型数据库，</li>
<li>是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</li>
<li>他支持的数据结构非常松散，采用的是类似 json 的 bjson 格式来存储数据，因此可以存储比较复杂的数据类型。Mongo 最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。</li>
</ol>

<p>下图展示了 mysql 和 mongoDB 之间的对应关系，我们可以看出来非常的方便，但是 mongoDB 的性能非常好。
<img src="https://TomatoAres.github.io/image/mongo/mongo-vs-mysql.png" alt="mongo Vs Mysql" /></p>

<h2 id="优缺点">优缺点</h2>

<p>优点：</p>

<ol>
<li>社区活跃，用户较多，应用广泛</li>
<li>MongoDB 在内存充足的情况下数据都放入内存且有完整的索引支持，查询效率较高</li>
<li>MongoDB 的分片机制，支持海量数据的存储和扩展</li>
</ol>

<p>缺点：</p>

<ol>
<li>不支持事务</li>
<li>不支持 join、复杂查询</li>
</ol>

<h2 id="go-基本操作">go 基本操作</h2>

<ol>
<li><p>链接</p>

<pre><code class="language-shell">s, err := mgo.Dial(addr)
.Close()
</code></pre></li>

<li><p>参数设置</p>

<pre><code class="language-shell">s.SetMode(mgo.Monotonic, true)
s.SetPoolLimit(maxPoolLimit)
s.SetSocketTimeout(timeout * time.Second)
</code></pre></li>

<li><p>建表</p>

<pre><code class="language-shell">s.DB(k).C(i).Create(&amp;info)
</code></pre></li>

<li><p>查询</p>

<pre><code class="language-shell">Find(bson.M{&quot;_id&quot;: id}).One(ret)
Find(nil).All()
bson.M{&quot;_id&quot;: id}
bson.M{}
bson.M  map[string]interface

</code></pre></li>

<li><p>修改</p>

<pre><code class="language-shell">bson.M{&quot;$push&quot;: bson.M{&quot;tasks&quot;: ret}}

bson.M{&quot;tasks.id&quot;: id},
bson.M{&quot;$set&quot;: bson.M{
&quot;tasks.$.status&quot;: status,
&quot;tasks.$.msg&quot;:    msg,
}}
</code></pre></li>
</ol>

<h2 id="mongo-遇到正则的坑">mongo 遇到正则的坑</h2>

<p>logmsg 存在这一条数据
{ &ldquo;_id&rdquo; : NumberLong(447187), &ldquo;msg&rdquo; : &ldquo;(模糊)详情：ap2(模糊查询包含括号)&rdquo; }</p>

<p>需求： 模糊匹配 <strong>(模糊)详情</strong></p>

<p>现在使用匹配查询</p>

<p>db.logmsg.find({msg:{$regex:/(模糊)详情/}); 查询不到数据
db.logmsg.find({msg:{$regex:/模糊/}); 去掉括号后可以查询到数据</p>

<p>已解决:加上转义</p>

<p>db.logmsg.find({msg:{$regex:/(模糊)详情/}); 查询不到数据</p>

<p>db.logmsg.find({msg:{$regex:“\(模糊\)详情&rdquo;}); 可以查询数据</p>

    </div>
    <div class="post-footer">
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "Ares-1" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </article>

    </main>
  </body>
</html>
